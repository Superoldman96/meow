; macOS hacking 3
; run simple shell
; cocomelonc
global start

section .text
start:
    ; sys_execve = 0x200003b
    xor     rax, rax
    mov     rax, 0x200003b       ; execve syscall on macOS x86_64

    lea     rdi, [rel path]      ; rdi = filename (char *filename)
    xor     rsi, rsi             ; rsi = argv (NULL)
    xor     rdx, rdx             ; rdx = envp (NULL)

    syscall                      ; execve("/bin/bash", NULL, NULL)

    ; fallback: exit(0)
    mov     rax, 0x2000001       ; sys_exit
    xor     rdi, rdi
    syscall

section .data
path:   db "/bin/bash", 0        ; OR: db "/bin/zsh", 0
